<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- FIX: Xóa khoảng trắng trong CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" />
    <link rel="stylesheet" href="../css/base.css" />
<link rel="stylesheet" href="../css/layout.css" />
<link rel="stylesheet" href="../css/components.css" />
<link rel="stylesheet" href="../css/pages/home.css" /><title>Trang chủ - Cloud Storage</title>
    <style>
        a {
            text-decoration: none;
            color: inherit;
        }
    </style>
</head>

<body>
    <div class="main-wrapper">
        <!-- Sidebar (cột trái) home-->
        <div class="sidebar-wrapper">
            <div class="sidebar-item active">
                <i class="fas fa-house-user"></i>
                <a href="trangchinh.html">Home</a>
                <p id="welcome">Xin chào bạn: </p>
            </div>

            <!-- <div class="sidebar-item">
                <i class="fas fa-layer-group"></i>
                 <a href="workspace.html">Workspaces</a> -->
            <!-- </div>  -->
            <div class="sidebar-item"><i class="fas fa-search"></i><a href="#">Search</a></div>
            <div class="sidebar-item"><i class="fas fa-bell"></i><a href="#">Notifications</a></div>
            <!-- workspace -->
            <!-- <div class="dropdown" id="workspaces-dropdown">
                <div class="dropdown-label">Workspaces <i class="fas fa-angle-down"></i></div>
                <div class="dropdown-menu">
                    <div class="dropdown-item"><i class="fas fa-graduation-cap"></i> College</div>
                    <div class="dropdown-item"><i class="fas fa-briefcase"></i> Work</div>
                    <div class="dropdown-item"><i class="fas fa-user-friends"></i> Family</div>
                    <div class="dropdown-item"><i class="fas fa-folder"></i> Others</div>
                </div>
            </div> -->
            <!-- categories -->
            <div class="dropdown open" id="categories-dropdown">
                <div class="dropdown-label">Categories <i class="fas fa-angle-down"></i></div>
                <div class="dropdown-menu">
                    <a href="category_document.html" class="dropdown-item">
                        <i class="fas fa-file-lines"></i> Documents
                    </a>
                    <a href="category_photo.html" class="dropdown-item">
                        <i class="fas fa-images"></i> Photos
                    </a>
                    <a href="category_video.html" class="dropdown-item">
                        <i class="fas fa-video"></i> Videos
                    </a>
                    <a href="category_audio.html" class="dropdown-item">
                        <i class="fas fa-music"></i> Audio
                    </a>
                    <a href="share.html" class="dropdown-item">
                        <i class="fas fa-share-from-square"></i> Shared with me
                    </a>
                    <a href="trash.html" class="dropdown-item">
                        <i class="fas fa-trash-can"></i> Trash
                    </a>
                </div>
            </div>
            <!-- footer -->
            <div class="footer">
                <div class="sidebar-item"><i class="fas fa-cog"></i> Settings</div>
                <div class="sidebar-item"><i class="far fa-question-circle"></i> Help & Feedback</div>
                <div class="sidebar-item admin-only" style="display: none;">
                    <i class="fas fa-shield-alt"></i>
                    <a href="admin.html">Admin Panel</a>
                </div>
            </div>
        </div>

        <!-- Main Content (cột giữa) -->
        <div class="Tong">
            <div class="container">
                <!-- Home -->
                <div class="Home_Le">
                    <h1><i class="fas fa-house-user"></i> Home</h1>
                </div>

                <div class="search-bar">
                    <i class="fas fa-search"></i>
                    <input type="text" id="mainSearch" placeholder="Search files, folders..." />
                </div>
                <!-- Recently -->
                <div class="section-header">
                    <h2>Recently opened</h2>
                    <a href="#" id="clearRecent">Clear all</a>
                </div>

                <div class="recently-opened">
                    <div class="file-card">
                        <div class="file-icon"><i class="fas fa-folder"></i></div>
                        <p class="file-name">Công nghệ web</p>
                    </div>
                    <div class="file-card">
                        <div class="file-icon"><i class="far fa-file-word"></i></div>
                        <p class="file-name">Ly_thuyet_cnw.docx</p>
                    </div>
                    <div class="file-card">
                        <div class="file-icon"><i class="far fa-file-image"></i></div>
                        <p class="file-name">TruongDaiHocSuPhamHaNoi.jpg</p>
                    </div>
                    <div class="file-card">
                        <div class="file-icon"><i class="far fa-file-excel"></i></div>
                        <p class="file-name">Thongkediemsomon_cnw.xlsx</p>
                    </div>
                </div>

                <!-- Categories Section -->
                <div class="section-header">
                    <h2>Categories</h2>
                </div>

                <div class="categories-grid">
                    <a href="category_document.html" class="category-card-link">
                        <div class="category-card">
                            <i class="fas fa-file-lines"></i>
                            <h3>Documents</h3>
                            <span class="file-count">0 files</span>
                        </div>
                    </a>
                    <a href="category_photo.html" class="category-card-link">
                        <div class="category-card">
                            <i class="fas fa-images"></i>
                            <h3>Photos</h3>
                            <span class="file-count">0 files</span>
                        </div>
                    </a>
                    <a href="category_video.html" class="category-card-link">
                        <div class="category-card">
                            <i class="fas fa-video"></i>
                            <h3>Videos</h3>
                            <span class="file-count">0 files</span>
                        </div>
                    </a>
                    <a href="category_audio.html" class="category-card-link">
                        <div class="category-card">
                            <i class="fas fa-music"></i>
                            <h3>Audio</h3>
                            <span class="file-count">0 files</span>
                        </div>
                    </a>
                    <a href="share.html" class="category-card-link">
                        <div class="category-card">
                            <i class="fas fa-share-from-square"></i>
                            <h3>Shared</h3>
                            <span class="file-count">0 files</span>
                        </div>
                    </a>
                    <a href="trash.html" class="category-card-link">
                        <div class="category-card">
                            <i class="fas fa-trash-can"></i>
                            <h3>Trash</h3>
                            <span class="file-count">0 files</span>
                        </div>
                    </a>
                </div>

                <!-- All file -->
                <div class="section-header">
                    <h2>All files</h2>
                    <div class="icon_folder_Home">
                        <i class="fa-solid fa-bars"></i>
                    </div>
                </div>

                <div class="box_name">
                    <div class="filter-tag">Documents</div>
                    <div class="filter-tag">Photos</div>
                    <div class="filter-tag">Videos</div>
                    <div class="filter-tag">Compressed ZIPs</div>
                    <div class="filter-tag">Audio</div>
                    <div class="filter-tag">Select file type</div>
                </div>

                <div class="folder_con" id="allFiles">
                    <!-- Nội dung all files giữ nguyên -->
                    <div class="file-item" data-type="folder"><i class="fas fa-folder"></i> haha</div>
                    <div class="file-item" data-type="folder"><i class="fas fa-folder"></i> HoangMyLinh</div>
                    <div class="file-item" data-type="folder"><i class="fas fa-folder"></i> ViThiPhuong</div>
                    <div class="file-item" data-type="folder"><i class="fas fa-folder"></i> Mon nen tang phat trien web</div>
                    <div class="file-item" data-type="email"><i class="far fa-envelope"></i> emailcuatoi</div>
                    <div class="file-item" data-type="code"><i class="fab fa-html5"></i> duanlon.html</div>
                    <div class="file-item" data-type="audio"><i class="fas fa-music"></i> nhactrungthu...</div>
                    <div class="file-item" data-type="archive"><i class="far fa-file-archive"></i> tonghopcacfileduanlon.zip</div>
                    <div class="file-item" data-type="video"><i class="fas fa-film"></i> nhacdiem10..</div>
                </div>
            </div>
        </div>

        <!-- Right Panel (cột phải) -->
        <div class="right-panel">
            <div class="user-section">
                <i class="fas fa-circle-user"></i>
                <div class="user-name" id="rightPanelUserName">linh</div>
            </div>

            <div class="upload-btn">
                <i class="fa-solid fa-cloud-arrow-up"></i> <a href="upload.html">Upload file</a>
            </div>

            <div class="quick-links">
                <div class="quick-link"><a href="#"><i class="fas fa-star"></i> Starred</a></div>
                <div class="quick-link"><a href="share.html"><i class="fas fa-share-from-square"></i> Shared with me</a></div>
                <div class="quick-link"><a href="#"><i class="fas fa-clock"></i> Recent</a></div>
                <div class="quick-link"><a href="trash.html"><i class="fas fa-trash-can"></i> Trash</a></div>
            </div>
        </div>
    </div>

    <script>
        // Đợi DOM load xong
        document.addEventListener('DOMContentLoaded', function() {
            // Hiển thị tên người dùng
            let user = JSON.parse(localStorage.getItem('user')) || {};
            document.getElementById('welcome').innerHTML += user.taikhoan || 'Khách';
            
            // Cập nhật tên người dùng trong thanh bên phải
            document.getElementById('rightPanelUserName').textContent = user.taikhoan || 'User';

            // Hiển thị Admin Panel nếu là admin
            const adminItems = document.querySelectorAll('.admin-only');
            if (user.quyen === 'admin') {
                adminItems.forEach(el => el.style.display = 'flex');
            } else {
                adminItems.forEach(el => el.style.display = 'none');
            }

            // Toggle dropdowns
            document.querySelectorAll('.dropdown-label').forEach(label => {
                label.addEventListener('click', () => {
                    const parent = label.parentElement;
                    parent.classList.toggle('open');
                });
            });

            // Cập nhật tổng số file từ localStorage
            const allFiles = JSON.parse(localStorage.getItem('uploadedFiles') || '[]');
            const counts = {
                document: allFiles.filter(f => f.category === 'document').length,
                photo: allFiles.filter(f => f.category === 'photo').length,
                video: allFiles.filter(f => f.category === 'video').length,
                audio: allFiles.filter(f => f.category === 'audio').length
            };

            document.querySelectorAll('.category-card').forEach(card => {
                const title = card.querySelector('h3').textContent.trim();
                let count = 0;
                if (title === 'Documents') count = counts.document;
                else if (title === 'Photos') count = counts.photo;
                else if (title === 'Videos') count = counts.video;
                else if (title === 'Audio') count = counts.audio;
                card.querySelector('.file-count').textContent = `${count} files`;
            });

            // Tìm kiếm
            document.getElementById('mainSearch').addEventListener('input', function (e) {
                const query = e.target.value.toLowerCase();
                document.querySelectorAll('#allFiles .file-item').forEach(file => {
                    const name = file.textContent.toLowerCase();
                    file.style.display = name.includes(query) ? 'flex' : 'none';
                });
            });

            // Clear recent
            document.getElementById('clearRecent').addEventListener('click', function (e) {
                e.preventDefault();
                if (confirm('Clear all recently opened items?')) {
                    document.querySelector('.recently-opened').innerHTML = '<div style="grid-column: 1/-1; text-align: center; color: #9ca3af;">No recent files</div>';
                }
            });

            // Mở sẵn dropdown categories
            document.getElementById('categories-dropdown').classList.add('open');
            const userSection = document.querySelector('.user-section');
            const userMenu = document.createElement('div');
            userMenu.className = 'user-menu';
            userMenu.innerHTML = `
                <div class="menu-item"><a href="admin.html"><i class="fas fa-users"></i> Manage Users</a></div>
                <div class="menu-item"><a href="#"><i class="fas fa-cog"></i> Account Settings</a></div>
            `;
            document.body.appendChild(userMenu);

            userSection.addEventListener('mouseenter', function() {
                if (user.quyen === 'admin') {
                    const rect = userSection.getBoundingClientRect();
                    userMenu.style.display = 'block';
                    userMenu.style.top = `${rect.bottom + window.scrollY}px`;
                    userMenu.style.left = `${rect.left + window.scrollX}px`;
                }
            });

            userSection.addEventListener('mouseleave', function() {
                userMenu.style.display = 'none';
            });

            // Đảm bảo menu ẩn khi click ra ngoài
            document.addEventListener('click', function(e) {
                if (!userSection.contains(e.target) && !userMenu.contains(e.target)) {
                    userMenu.style.display = 'none';
                }
            });
        });
        // Thêm đoạn này vào script của trang chủ (sau khi lấy user)
if (!localStorage.getItem('users')) {
    localStorage.setItem('users', JSON.stringify([
        { taikhoan: 'linh', hoten: 'Hoàng My Linh', email: 'linh@example.com', quyen: 'user', status: 'active' },
        { taikhoan: 'admin', hoten: 'Administrator', email: 'admin@example.com', quyen: 'admin', status: 'active' },
        { taikhoan: 'phuong', hoten: 'Vì Thị Phương', email: 'phuong@example.com', quyen: 'user', status: 'inactive' }
    ]));
}
    </script>
</body>

</html>